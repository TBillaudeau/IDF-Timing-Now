"use strict";(self.webpackChunkrailtime_idf=self.webpackChunkrailtime_idf||[]).push([[173],{6524:function(e,n,i){i.r(n),i.d(n,{default:function(){return T}});var t=i(4165),o=i(5861),r=i(9439),s=i(9867),a=i(4670),l=i(7353),d=i(4942),c=i(1413),m=i(8100),u=i(5147),h=i(3397),p=i(8543),v=i(1891),x=i(470),f=i.n(x),g=(i(6948),i(2095)),j=i(1211),w=i(9790),k=i(8039),_=i(2834);var y=function(e){var n=e.journeyData,i=(0,s.useState)({}),t=(0,r.Z)(i,2),o=t[0],a=t[1],x=n.sections.map((function(e,n){var i,t,o,s,a,l=(null===(i=e.geojson)||void 0===i?void 0:i.coordinates.map((function(e){var n=(0,r.Z)(e,2),i=n[0];return[n[1],i]})))||[];return{index:n,coordinates:l,color:e.display_informations&&e.display_informations.color?"#".concat(e.display_informations.color):"#333333",markerPosition:l[0]||null,lineName:(null===(t=e.display_informations)||void 0===t?void 0:t.code)||"Line ".concat(n+1),lineID:null===(o=e.links[1])||void 0===o?void 0:o.id,from:e.from,to:e.to,terminus:(null===(s=e.display_informations)||void 0===s?void 0:s.direction)||"Unknown",mode:(null===(a=e.display_informations)||void 0===a?void 0:a.commercial_mode)||e.mode,stop_date_times:e.stop_date_times?e.stop_date_times.slice(1,-1):[],departure:new Date(e.departure_date_time.replace(/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})/,"$1-$2-$3T$4:$5:$6")).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),arrival:new Date(e.arrival_date_time.replace(/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})/,"$1-$2-$3T$4:$5:$6")).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),duration:Math.floor(e.duration/60)}})),y=x[0].coordinates[0][0]-(x[0].coordinates[0][0]+x[x.length-1].coordinates[0][0])/2,N=x[0].coordinates[0][1]-(x[0].coordinates[0][1]+x[x.length-1].coordinates[0][1])/2,b=Math.sqrt(y*y+N*N),T=Math.floor(8-Math.log(b)/Math.log(2)),D=function(){var e=(0,m.Sx)();return(0,s.useEffect)((function(){var n=new(f().Control)({position:"bottomright"});return n.onAdd=function(){var n=f().DomUtil.create("button","leaflet-bar leaflet-control leaflet-control-custom");return n.innerHTML='<svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 14 20"><path d="M7 0a7 7 0 0 0-1 13.92V19a1 1 0 1 0 2 0v-5.08A7 7 0 0 0 7 0Zm0 5.5A1.5 1.5 0 0 0 5.5 7a1 1 0 0 1-2 0A3.5 3.5 0 0 1 7 3.5a1 1 0 0 1 0 2Z"/></svg>',n.style.cssText="background-color: white; padding: 6px; cursor: pointer;",n.onclick=function(){return e.flyTo([(x[0].coordinates[0][0]+x[x.length-1].coordinates[0][0])/2,(x[0].coordinates[0][1]+x[x.length-1].coordinates[0][1])/2],T)},n},n.addTo(e),function(){return n.remove()}}),[e]),null};return(0,_.jsxs)("div",{className:"max-w-4xl mx-auto",children:[x.length>0&&(0,_.jsx)("div",{children:(0,_.jsxs)(u.h,{className:"z-10 h-96",center:[(x[0].coordinates[0][0]+x[x.length-1].coordinates[0][0])/2,(x[0].coordinates[0][1]+x[x.length-1].coordinates[0][1])/2],zoom:T,attributionControl:!1,children:[(0,_.jsx)(h.I,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png"}),(0,_.jsx)(D,{}),x.map((function(e,n){return(0,_.jsxs)(s.Fragment,{children:[(0,_.jsx)(p.a,{positions:e.coordinates,color:e.color,dashArray:"walking"===e.mode?"5, 5":null}),e.coordinates[0]&&e.duration>1&&(0,_.jsx)(_.Fragment,{children:e.lineID&&(0,_.jsx)(v.J,{position:e.coordinates[0],icon:f().divIcon({className:"my-div-icon",html:k.renderToString((0,_.jsx)(w.BU,{lineID:e.lineID.split(":").pop(),className:"h-5"})),iconSize:[25],iconAnchor:[10,20],popupAnchor:[0,-40]})})})]},n)}))]})}),x.map((function(e,n){var i,t,r,s,m,u,h,p,v,x,f,k,y,N,b=e.from&&e.to&&(null===(i=e.from)||void 0===i||null===(t=i.stop_point)||void 0===t||null===(r=t.stop_area)||void 0===r?void 0:r.name)===(null===(s=e.to)||void 0===s||null===(m=s.stop_point)||void 0===m||null===(u=m.stop_area)||void 0===u?void 0:u.name),T=!e.from&&!e.to&&e.duration,D=e.color;return"walking"===e.mode&&0===e.duration?null:(0,_.jsxs)("div",{className:"bg-white relative flex p-4",children:[(0,_.jsxs)("div",{className:"w-10 flex justify-center mr-4 flex-wrap",children:["                            ",(0,_.jsx)("div",{style:{background:"walking"===e.mode||void 0===e.mode?"linear-gradient(".concat(D," 50%, transparent 50%)"):D,backgroundSize:"1px 10px"},className:"absolute w-1 h-full z-10 top-6"}),(0,_.jsxs)("div",{className:"flex flex-col items-center space-y-2 mb-2 absolute z-20",children:[void 0===e.mode||b?(0,_.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 19 30",className:"h-6 lg:h-10",children:(0,_.jsx)("path",{fill:"#fff",stroke:"#000","stroke-width":"2.5",d:"M1.75 9a7.75 7.75 0 1 1 15.5 0v12a7.75 7.75 0 0 1-15.5 0V9Z"})}):(0,_.jsx)("img",{src:"/IDF-Timing-Now"+"/images/".concat((0,l.H2)(e.mode),".svg"),alt:(0,l.H2)(e.mode),className:"bg-white h-6 lg:h-10"}),e.lineID&&(0,_.jsx)(w.BU,{lineID:e.lineID.split(":").pop(),className:"h-6 lg:h-10"})]})]}),(0,_.jsx)("div",{className:"space-y-6 w-full",children:b?(0,_.jsxs)("p",{className:"text-sm",children:[e.duration," minutes de correspondance"]}):T?(0,_.jsxs)("p",{className:"text-sm",children:[e.duration," minutes d'attente"]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:"flex justify-between font-bold",children:[(0,_.jsx)("p",{children:(null===(h=e.from)||void 0===h||null===(p=h.stop_point)||void 0===p||null===(v=p.stop_area)||void 0===v?void 0:v.name)||(null===(x=e.from)||void 0===x?void 0:x.name)}),(0,_.jsx)("p",{children:e.departure})]}),"Unknown"!==e.terminus&&(0,_.jsxs)("div",{className:"flex items-center text-xs",children:[(0,_.jsx)("svg",{className:"w-2 h-2 mr-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 10",children:(0,_.jsx)("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M1 5h12m0 0L9 1m4 4L9 9"})}),e.terminus]})]}),"walking"!==e.mode&&void 0!==e.mode&&(0,_.jsx)(g.Z,{lineID:e.lineID.split(":").pop(),stationName:function(){try{var n=j.find((function(n){return n.arrid===e.from.id.split(":").pop()}));return n||(n=j.find((function(n){return n.zdaid===e.from.id.split(":").pop()}))),n?n.zdcid:""}catch(i){return console.error("Error accessing zdcid:",i),""}}()}),(0,_.jsxs)("div",{className:"flex items-center space-x-2 text-gray-500 text-sm",children:[(0,_.jsxs)("p",{children:[e.stop_date_times.length+1," arr\xeats | ",e.duration," min"]}),(0,_.jsx)("button",{onClick:function(){return n=e.id,void a((function(e){return(0,c.Z)((0,c.Z)({},e),{},(0,d.Z)({},n,!e[n]))}));var n},children:o?(0,_.jsx)("svg",{class:"w-2 h-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 8",children:(0,_.jsx)("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7 7.674 1.3a.91.91 0 0 0-1.348 0L1 7"})}):(0,_.jsx)("svg",{class:"w-2 h-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 8",children:(0,_.jsx)("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 5.326 5.7a.909.909 0 0 0 1.348 0L13 1"})})})]}),o[e.id]&&(0,_.jsx)("ul",{children:e.stop_date_times.map((function(e,n){return(0,_.jsx)("li",{children:e.stop_point.name},n)}))}),(0,_.jsxs)("div",{className:"flex justify-between font-bold",children:[(0,_.jsx)("p",{children:(null===(f=e.to)||void 0===f||null===(k=f.stop_point)||void 0===k||null===(y=k.stop_area)||void 0===y?void 0:y.name)||(null===(N=e.to)||void 0===N?void 0:N.name)}),(0,_.jsx)("p",{children:e.arrival})]})]})})]},e.index)}))]})},N=i(2382),b=i.n(N);var T=function(){var e=new URLSearchParams((0,a.TH)().search),n=e.get("from"),i=e.get("to"),d=(0,s.useState)([]),c=(0,r.Z)(d,2),m=c[0],u=c[1],h=(0,s.useState)(null),p=(0,r.Z)(h,2),v=p[0],x=p[1],f=(0,s.useRef)(null);return(0,s.useEffect)((function(){var e=function(){var e=(0,o.Z)((0,t.Z)().mark((function e(){var o,r;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://prim.iledefrance-mobilites.fr/marketplace/navitia/coverage/fr-idf/journeys?from=".concat(n,"&to=").concat(i),{headers:{apikey:"l5iC8ZUjTN6WAevyFkU1tV8zkTbmNdjb"}});case 2:return o=e.sent,e.next=5,o.json();case 5:r=e.sent,console.log(r),u(r.journeys?r.journeys:[]);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,s.useEffect)((function(){v&&f.current&&f.current.scrollIntoView({behavior:"smooth"})}),[v]),(0,_.jsx)("div",{children:m.length>0?(0,_.jsxs)("div",{children:[m.map((function(e,n){var i,t=function(e){var n=Math.floor(e/3600),i=Math.floor(e%3600/60);return 0===n?"".concat(i," min"):"".concat(n," h ").concat(i," min")}(e.durations.total),o=(i=e.fare).found?"".concat((i.total.value/100).toFixed(2)," ").concat("centime"===i.total.currency?"EUR":i.total.currency):"Not available",r=new Date(new Date(e.departure_date_time.replace(/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})/,"$1-$2-$3T$4:$5:$6Z")).getTime()-36e5).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),a=new Date(new Date(e.arrival_date_time.replace(/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})/,"$1-$2-$3T$4:$5:$6Z")).getTime()-36e5).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return(0,_.jsxs)("div",{className:"flex flex-col p-2 bg-white dark:bg-gray-800 dark:text-white cursor-pointer ".concat(v===e?"sticky top-0 z-50":""),onClick:function(){return function(e){x(e)}(e)},children:["                                ",(0,_.jsx)("div",{className:"flex overflow-x-auto py-2",children:e.sections.map((function(n,i){var t,o,r,a,d,c,m;return(0,_.jsx)(s.Fragment,{children:(0,_.jsxs)("div",{className:"flex items-center gap-1 shrink-0",children:[(null!==(t=n.display_informations)&&void 0!==t&&t.commercial_mode||n.mode)&&("walking"!==n.mode||"walking"===n.mode&&n.duration>=60)?(0,_.jsx)("img",{src:"/IDF-Timing-Now"+"/images/".concat((0,l.H2)((null===(o=n.display_informations)||void 0===o?void 0:o.commercial_mode)||n.mode)).concat("dark"===localStorage.theme?"_LIGHT":"",".svg"),alt:(0,l.H2)(null===(r=n.display_informations)||void 0===r?void 0:r.commercial_mode),className:"h-6 lg:h-10"}):null,null!==(a=n.links[1])&&void 0!==a&&a.id?(0,_.jsx)(w.BU,{lineID:null===(d=n.links[1])||void 0===d?void 0:d.id.split(":").pop(),className:"h-6 lg:h-10"}):null,i<e.sections.length-1&&((null===(c=n.display_informations)||void 0===c?void 0:c.commercial_mode)||n.mode||(null===(m=n.links[1])||void 0===m?void 0:m.id))&&(("walking"!==n.mode||"walking"===n.mode&&n.duration>=60)&&i!==e.sections.length-2?(0,_.jsx)("svg",{className:"w-2 h-2 mr-0.5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 8 14",children:(0,_.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"m1 13 5.7-5.326a.909.909 0 0 0 0-1.348L1 1"})}):null)]})},i)}))}),(0,_.jsxs)("div",{className:"flex justify-between items-center",children:[(0,_.jsx)("p",{className:"text-sm",children:o}),(0,_.jsxs)("div",{className:"text-right",children:[(0,_.jsx)("p",{children:(0,_.jsx)("strong",{children:t})}),(0,_.jsxs)("p",{className:"text-sm",children:[r," - ",a]})]})]})]},n)})),v&&(0,_.jsx)("div",{ref:f,children:(0,_.jsx)(y,{journeyData:v},Date.now())})]}):(0,_.jsx)("div",{className:"flex items-center justify-center",style:{height:"calc(100vh - 130px)"},children:(0,_.jsx)(b(),{size:30,color:"#6D28D9"})})})}}}]);
//# sourceMappingURL=173.285e360a.chunk.js.map