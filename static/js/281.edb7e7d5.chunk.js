"use strict";(self.webpackChunkrailtime_idf=self.webpackChunkrailtime_idf||[]).push([[281],{9212:function(e,t,n){var r=n(9439),l=n(9867),i=n(5374),o=n(9228),a=n(2834);t.Z=function(e){var t=e.lineID,n=e.className,s=(0,l.useState)(""),u=(0,r.Z)(s,2),d=u[0],c=u[1];return(0,l.useEffect)((function(){var e=o.find((function(e){return e.fields.id_line===t}));if(e){var n=e.fields.name_line,r="#"+e.fields.colourweb_hexa,l="#"+e.fields.textcolourweb_hexa;c('\n                    <svg viewBox="0 0 120 120">\n                        <rect x="0" y="'.concat(21.5,'" width="100%" height="77" rx="10" ry="10" fill="').concat(r,'" />\n                        <text x="50%" y="53%" fill="').concat(l,'" font-family="Arial" font-size="45" text-anchor="middle" alignment-baseline="middle" font-weight="bold">').concat(n,"</text>\n                    </svg>\n                "))}}),[t]),(0,a.jsx)(i.Z,{src:d,className:n})}},6894:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var r=n(4165),l=n(5861),i=n(9439),o=n(9867),a=n(8100),s=n(5147),u=n(3397),d=n(470),c=n.n(d),v=(n(6948),n(7353)),f=(n(1211),n(4467),n(9228)),m=n(9212),p=n(2834);var h=function(e){e.lineID;var t=e.stationName,n=(0,o.useState)([]),r=(0,i.Z)(n,2),l=r[0],a=r[1],s=(0,o.useState)(""),u=(0,i.Z)(s,2),d=u[0],c=u[1],h="https://prim.iledefrance-mobilites.fr/marketplace/stop-monitoring?MonitoringRef=STIF:StopArea:SP:".concat(t,":");function g(e){var t;return function(e,t,n){var r=[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)],l=r[0],i=r[1],o=r[2],a=[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)],s=a[0],u=a[1],d=a[2];return((Math.round(l*(1-n)+s*n)<<16)+(Math.round(i*(1-n)+u*n)<<8)+Math.round(o*(1-n)+d*n)).toString(16).padStart(6,"0")}(null===(t=f.find((function(t){return t.fields.id_line==e})))||void 0===t?void 0:t.fields.colourweb_hexa,"ffffff",.5)}return(0,o.useEffect)((function(){var e=function(e,t,n){fetch(e,{headers:{Accept:"application/json",apikey:"l5iC8ZUjTN6WAevyFkU1tV8zkTbmNdjb"}}).then((function(e){return 404===e.status?null:e.json()})).then((function(e){var r,l,i,o,a=null===e||void 0===e||null===(r=e.Siri)||void 0===r||null===(l=r.ServiceDelivery)||void 0===l||null===(i=l.StopMonitoringDelivery[0])||void 0===i||null===(o=i.MonitoredStopVisit)||void 0===o?void 0:o.map((function(e){var t,n,r,l,i,o,a,s,u,d,c,v,f,m,p,h,g,x,y,w,b,j,N,M,S,k,A,D,T;return{lineRef:null===e||void 0===e||null===(t=e.MonitoredVehicleJourney)||void 0===t||null===(n=t.LineRef)||void 0===n?void 0:n.value,operatorRef:null===e||void 0===e||null===(r=e.MonitoredVehicleJourney)||void 0===r||null===(l=r.OperatorRef)||void 0===l?void 0:l.value,directionName:null===e||void 0===e||null===(i=e.MonitoredVehicleJourney)||void 0===i||null===(o=i.DirectionName[0])||void 0===o?void 0:o.value,destinationName:null===e||void 0===e||null===(a=e.MonitoredVehicleJourney)||void 0===a||null===(s=a.DestinationName[0])||void 0===s?void 0:s.value,vehicleJourneyName:null===e||void 0===e||null===(u=e.MonitoredVehicleJourney)||void 0===u||null===(d=u.VehicleJourneyName[0])||void 0===d?void 0:d.value,expectedArrivalTime:null===e||void 0===e||null===(c=e.MonitoredVehicleJourney)||void 0===c||null===(v=c.MonitoredCall)||void 0===v?void 0:v.ExpectedArrivalTime,aimedArrival:null===e||void 0===e||null===(f=e.MonitoredVehicleJourney)||void 0===f||null===(m=f.MonitoredCall)||void 0===m?void 0:m.AimedArrival,expectedDepartureTime:null===e||void 0===e||null===(p=e.MonitoredVehicleJourney)||void 0===p||null===(h=p.MonitoredCall)||void 0===h?void 0:h.ExpectedDepartureTime,aimedDepartureTime:null===e||void 0===e||null===(g=e.MonitoredVehicleJourney)||void 0===g||null===(x=g.MonitoredCall)||void 0===x?void 0:x.aimedDepartureTime,arrivalStatus:null===e||void 0===e||null===(y=e.MonitoredVehicleJourney)||void 0===y||null===(w=y.MonitoredCall)||void 0===w?void 0:w.ArrivalStatus,departureStatus:null===e||void 0===e||null===(b=e.MonitoredVehicleJourney)||void 0===b||null===(j=b.MonitoredCall)||void 0===j?void 0:j.DepartureStatus,vehicleAtStop:null===e||void 0===e||null===(N=e.MonitoredVehicleJourney)||void 0===N||null===(M=N.MonitoredCall)||void 0===M?void 0:M.VehicleAtStop,minutesFromNow:(T=(null===e||void 0===e||null===(S=e.MonitoredVehicleJourney)||void 0===S||null===(k=S.MonitoredCall)||void 0===k?void 0:k.ExpectedDepartureTime)||(null===e||void 0===e||null===(A=e.MonitoredVehicleJourney)||void 0===A||null===(D=A.MonitoredCall)||void 0===D?void 0:D.ExpectedArrivalTime),Math.round((new Date(T)-new Date)/6e4))}}));t(a.sort((function(e,t){return e.minutesFromNow-t.minutesFromNow}))),n(e.nextDepartures.errorMessage)})).catch((function(e){return console.error(e)}))};e(h,a,c);var t=setInterval((function(){return e(h,a,c)}),2e3);return function(){return clearInterval(t)}}),[t]),"NO_REALTIME_SCHEDULES_FOUND"===d?(0,p.jsx)("div",{className:"flex items-center justify-center text-center text-xs lg:text-base bg-white dark:bg-gray-700 dark:text-gray-200 rounded-lg shadow-md p-4 mb-3 h-[44px] lg:h-[72px]",children:(0,p.jsx)("p",{className:"animate-pulse",children:"Information en direct indisponible"})}):0===l.length?(0,p.jsx)("div",{className:"overflow-y-auto max-h-[27rem] animate-pulse",children:(0,p.jsxs)("div",{className:"flex items-center bg-white dark:bg-gray-800 rounded-lg shadow-md h-[44px] lg:h-[72px]",children:[(0,p.jsx)("div",{role:"status",class:"flex items-center justify-center w-4 lg:w-10 h-4 lg:h-10 ml-1 lg:ml-0 mr-2 lg:mr-4 p-1 bg-gray-300 rounded-sm lg:rounded-lg dark:bg-gray-700",children:(0,p.jsx)("svg",{class:"w-5 h-5 text-gray-200 dark:text-gray-600","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 18",children:(0,p.jsx)("path",{d:"M18 0H2a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm-5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm4.376 10.481A1 1 0 0 1 16 15H4a1 1 0 0 1-.895-1.447l3.5-7A1 1 0 0 1 7.468 6a.965.965 0 0 1 .9.5l2.775 4.757 1.546-1.887a1 1 0 0 1 1.618.1l2.541 4a1 1 0 0 1 .028 1.011Z"})})}),(0,p.jsxs)("div",{className:"flex-grow",children:[(0,p.jsx)("div",{class:"w-12 lg:w-24 h-1 lg:h-2.5 mb-1 lg:mb-2.5 bg-gray-300 rounded-full dark:bg-gray-600"}),(0,p.jsx)("div",{class:"w-16 lg:w-32 h-1 lg:h-2 bg-gray-200 rounded-full dark:bg-gray-700"})]}),(0,p.jsxs)("div",{className:"ml-2 lg:ml-5 min-w-max pr-2 text-right",children:[(0,p.jsx)("div",{class:"w-6 lg:w-12 h-1 lg:h-2.5 mb-1 lg:mb-2.5 mr-1 bg-gray-300 rounded-full dark:bg-gray-700"}),(0,p.jsx)("div",{class:"w-4 lg:w-8 h-1 lg:h-2 mr-1 bg-gray-200 rounded-full float-right dark:bg-gray-700"})]})]})}):(l.reduce((function(e,t){var n=(0,v.OV)(t.lineDirection);return e[n]||(e[n]=[]),e[n].push(t),e}),{}),(0,p.jsx)("div",{className:"",children:l.map((function(e,t){return(0,p.jsxs)("div",{className:"flex items-center bg-white border-gray-400 dark:text-white dark:bg-gray-700 min-h-[44px] max-h-[72px] p-1 lg:p-4 relative",style:{borderBottom:"4px solid #".concat(g(e.lineRef.replace(/:$/,"").split(":").pop()))},children:[(0,p.jsxs)("div",{className:"shrink-0",children:[(0,p.jsx)(m.Z,{lineID:e.lineRef.replace(/:$/,"").split(":").pop(),className:"h-6 lg:h-10 pl-1 lg:pl-0 mr-2 lg:mr-4"}),(0,p.jsx)("h3",{className:"text-[8px] lg:text-xs justify-center flex mx-auto mt-0.5 pl-0.5 lg:pl-0",children:e.vehicleJourneyName})]}),(0,p.jsx)("div",{className:"flex-grow overflow-hidden",children:(0,p.jsxs)("h2",{className:"font-bold text-[11px] lg:text-lg line-clamp-2 ml-2 lg:ml-4",children:[e.destinationName," - ",e.aimedArrival," - ",e.vehicleAtStop]})}),(0,p.jsxs)("div",{className:"ml-1 lg:ml-5 pr-2 text-right",children:[(0,p.jsxs)("p",{className:"text-sm lg:text-2xl font-bold",children:[e.departureStatus," ",e.minutesFromNow,"\u1d50\u2071\u207f"]}),(0,p.jsxs)("p",{className:"text-xs lg:text-sm text-right text-gray-400 dark:text-white",children:["Arrival: ",new Date(e.expectedArrivalTime).toLocaleTimeString()]}),(0,p.jsxs)("p",{className:"text-xs lg:text-sm text-right text-gray-400 dark:text-white",children:["Departure: ",new Date(e.expectedDepartureTime).toLocaleTimeString()]})]}),(0,p.jsx)("div",{className:"absolute top-0 right-0 bottom-0 left-0 lg:left-0 bg-gradient-to-r from-transparent to-white dark:to-gray-700",style:{backgroundImage:"linear-gradient(to right, transparent, rgba(".concat(parseInt(g(e.lineRef.replace(/:$/,"").split(":").pop()).slice(0,2),16),", ").concat(parseInt(g(e.lineRef.replace(/:$/,"").split(":").pop()).slice(2,4),16),", ").concat(parseInt(g(e.lineRef.replace(/:$/,"").split(":").pop()).slice(4,6),16),", 0.1))")}})]},t)}))}))},g=n(342),x=n(3743),y=(n(1550),function(){var e=(0,o.useState)(null),t=(0,i.Z)(e,2),n=t[0],d=t[1],v=(0,o.useState)(""),f=(0,i.Z)(v,2),m=f[0],y=f[1],w=(0,o.useRef)(),b=function(){var e=(0,o.useState)(null),t=(0,i.Z)(e,2),n=t[0],s=t[1];return(0,a.zV)({moveend:function(e){var t=e.target.getCenter();s(t)}}),(0,o.useEffect)((function(){if(n){var e=function(){var e=(0,l.Z)((0,r.Z)().mark((function e(){var t,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://prim.iledefrance-mobilites.fr/marketplace/navitia/coverage/fr-idf/coord/".concat(n.lng,";").concat(n.lat,"/stop_areas?distance=400"),{headers:{apikey:"l5iC8ZUjTN6WAevyFkU1tV8zkTbmNdjb"}});case 2:return t=e.sent,e.next=5,t.json();case 5:l=e.sent,y(l.stop_areas);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[n]),null},j=function(){return(0,p.jsx)("span",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1000] bg-violet-700 rounded-full p-2 border-4 border-white"})};(0,o.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){d([e.coords.latitude,e.coords.longitude])}),(function(e){console.error("Error occurred while getting geolocation: ",e),n||d([48.8598,2.347])}))}),[]);var N=function(){var e=(0,a.Sx)();return(0,o.useEffect)((function(){var t=new(c().Control)({position:"bottomright"});return t.onAdd=function(){var t=c().DomUtil.create("button","leaflet-bar leaflet-control leaflet-control-custom");return t.innerHTML='<svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 14 20"><path d="M7 0a7 7 0 0 0-1 13.92V19a1 1 0 1 0 2 0v-5.08A7 7 0 0 0 7 0Zm0 5.5A1.5 1.5 0 0 0 5.5 7a1 1 0 0 1-2 0A3.5 3.5 0 0 1 7 3.5a1 1 0 0 1 0 2Z"/></svg>',t.style.cssText="background-color: white; padding: 6px; cursor: pointer;",t.onclick=function(){return n&&e.flyTo(n,13)},t},t.addTo(e),function(){return t.remove()}}),[e]),null};return(0,p.jsxs)("div",{style:{height:"calc(100vh - 130px)"},children:[n&&(0,p.jsxs)(s.h,{className:"h-[40%]",whenCreated:function(e){w.current=e},center:n,zoom:13,attributionControl:!1,children:[(0,p.jsx)(u.I,{url:"https://{s}.tile.jawg.io/jawg-streets/{z}/{x}/{y}{r}.png?access-token=".concat("NLjqJ26jQLT3FtdLL3392vMpTDEAjiSi3aye5i0XblTjBD5Eo0N1Q5HjG5FReW7u")}),(0,p.jsx)(b,{}),(0,p.jsx)(N,{}),(0,p.jsx)(j,{}),g.map((function(e,t){return(0,p.jsx)(x.Q,{data:e.geo_shape.geometry,style:{color:"#"+e.colourweb_hexa}},t)}))]}),m&&(0,p.jsx)("div",{className:"h-[60%] overflow-y-scroll",children:m.map((function(e,t){return(0,p.jsx)(h,{line:null,stationName:e.id.split(":").pop()})}))})]})})},3743:function(e,t,n){n.d(t,{Q:function(){return u}});var r=n(4925),l=n(5293),i=n(9457),o=n(5430),a=n(470),s=["data"],u=(0,l.Au)((function(e,t){var n=e.data,l=(0,r.Z)(e,s),u=new a.GeoJSON(n,l);return(0,i.O)(u,(0,o.sj)(t,{overlayContainer:u}))}),(function(e,t,n){t.style!==n.style&&(null==t.style?e.resetStyle():e.setStyle(t.style))}))},8100:function(e,t,n){n.d(t,{Sx:function(){return i},zV:function(){return o}});var r=n(5430),l=n(9867);function i(){return(0,r.mE)().map}function o(e){var t=i();return(0,l.useEffect)((function(){return t.on(e),function(){t.off(e)}}),[t,e]),t}}}]);
//# sourceMappingURL=281.edb7e7d5.chunk.js.map