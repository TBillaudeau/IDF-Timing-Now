"use strict";(self.webpackChunkrailtime_idf=self.webpackChunkrailtime_idf||[]).push([[344],{2814:function(e,n,t){var o=t(9439),i=t(9867),r=t(9790),l=(t(9673),t(2834));n.Z=function(e){e.lineID;var n=e.stationName,t=(0,i.useState)([]),a=(0,o.Z)(t,2),u=a[0],d=a[1],c=(0,i.useState)(""),s=(0,o.Z)(c,2),v=s[0],f=(s[1],(0,i.useState)("current")),m=(0,o.Z)(f,2),p=(m[0],m[1],(0,i.useState)(null)),h=(0,o.Z)(p,2),x=(h[0],h[1],"https://prim.iledefrance-mobilites.fr/marketplace/stop-monitoring?MonitoringRef=STIF:StopArea:SP:".concat(n,":"));if((0,i.useEffect)((function(){var e=function(e,n,t){fetch(e,{headers:{Accept:"application/json",apikey:"l5iC8ZUjTN6WAevyFkU1tV8zkTbmNdjb"}}).then((function(e){return 404===e.status?null:e.json()})).then((function(e){var t,o,i,r,l=null===e||void 0===e||null===(t=e.Siri)||void 0===t||null===(o=t.ServiceDelivery)||void 0===o||null===(i=o.StopMonitoringDelivery[0])||void 0===i||null===(r=i.MonitoredStopVisit)||void 0===r?void 0:r.map((function(e){var n,t,o,i,r,l,a,u,d,c,s,v,f,m,p,h,x,g,y,j,N,M,b,w,S,T,C,V,k,A,J,Z,D,E,F,I,_,R;return{lineRef:null===e||void 0===e||null===(n=e.MonitoredVehicleJourney)||void 0===n||null===(t=n.LineRef)||void 0===t?void 0:t.value,operatorRef:null===e||void 0===e||null===(o=e.MonitoredVehicleJourney)||void 0===o||null===(i=o.OperatorRef)||void 0===i?void 0:i.value,stopPointName:null===e||void 0===e||null===(r=e.MonitoredVehicleJourney)||void 0===r||null===(l=r.MonitoredCall)||void 0===l||null===(a=l.StopPointName[0])||void 0===a?void 0:a.value,directionName:null===e||void 0===e||null===(u=e.MonitoredVehicleJourney)||void 0===u||null===(d=u.DirectionName[0])||void 0===d?void 0:d.value,destinationName:null===e||void 0===e||null===(c=e.MonitoredVehicleJourney)||void 0===c||null===(s=c.DestinationName[0])||void 0===s?void 0:s.value,vehicleJourneyName:null===e||void 0===e||null===(v=e.MonitoredVehicleJourney)||void 0===v||null===(f=v.JourneyNote[0])||void 0===f?void 0:f.value,expectedArrivalTime:null===e||void 0===e||null===(m=e.MonitoredVehicleJourney)||void 0===m||null===(p=m.MonitoredCall)||void 0===p?void 0:p.ExpectedArrivalTime,aimedArrival:null===e||void 0===e||null===(h=e.MonitoredVehicleJourney)||void 0===h||null===(x=h.MonitoredCall)||void 0===x?void 0:x.AimedArrival,expectedDepartureTime:null===e||void 0===e||null===(g=e.MonitoredVehicleJourney)||void 0===g||null===(y=g.MonitoredCall)||void 0===y?void 0:y.ExpectedDepartureTime,aimedDepartureTime:null===e||void 0===e||null===(j=e.MonitoredVehicleJourney)||void 0===j||null===(N=j.MonitoredCall)||void 0===N?void 0:N.aimedDepartureTime,arrivalStatus:null===e||void 0===e||null===(M=e.MonitoredVehicleJourney)||void 0===M||null===(b=M.MonitoredCall)||void 0===b?void 0:b.ArrivalStatus,departureStatus:null===e||void 0===e||null===(w=e.MonitoredVehicleJourney)||void 0===w||null===(S=w.MonitoredCall)||void 0===S?void 0:S.DepartureStatus,vehicleAtStop:null===e||void 0===e||null===(T=e.MonitoredVehicleJourney)||void 0===T||null===(C=T.MonitoredCall)||void 0===C?void 0:C.VehicleAtStop,arrivalPlatform:null===e||void 0===e||null===(V=e.MonitoredVehicleJourney)||void 0===V||null===(k=V.MonitoredCall)||void 0===k||null===(A=k.ArrivalPlatformName)||void 0===A?void 0:A.value,trainNumber:null===e||void 0===e||null===(J=e.MonitoredVehicleJourney)||void 0===J||null===(Z=J.TrainNumber)||void 0===Z||null===(D=Z.TrainNumberRef[0])||void 0===D?void 0:D.value,minutesFromNow:(R=(null===e||void 0===e||null===(E=e.MonitoredVehicleJourney)||void 0===E||null===(F=E.MonitoredCall)||void 0===F?void 0:F.ExpectedDepartureTime)||(null===e||void 0===e||null===(I=e.MonitoredVehicleJourney)||void 0===I||null===(_=I.MonitoredCall)||void 0===_?void 0:_.ExpectedArrivalTime),Math.floor((new Date(R)-new Date)/6e4))}}));n(l.sort((function(e,n){return e.minutesFromNow-n.minutesFromNow})))})).catch((function(e){return console.error(e)}))};e(x,d);var n=setInterval((function(){return e(x,d)}),2e3);return function(){return clearInterval(n)}}),[]),"NO_REALTIME_SCHEDULES_FOUND"===v)return(0,l.jsx)("div",{className:"flex items-center justify-center text-center text-xs lg:text-base bg-white dark:bg-gray-700 dark:text-gray-200 rounded-lg shadow-md p-4 mb-3 h-[44px] lg:h-[72px]",children:(0,l.jsx)("p",{className:"animate-pulse",children:"Information en direct indisponible"})});var g=u.reduce((function(e,n){var t=n.lineRef;e[t]||(e[t]={});var o=n.destinationName;return e[t][o]||(e[t][o]=[]),e[t][o].push(n),e}),{});return(0,l.jsx)("div",{className:"",children:Object.entries(g).map((function(e){var n=(0,o.Z)(e,2),t=n[0],i=n[1];return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)("img",{src:"/IDF-Timing-Now"+"/images/".concat((0,r.tX)(t.split("::").pop().split(":")[0])).concat("dark"===localStorage.theme?"_LIGHT":"",".svg"),alt:(0,r.tX)(t.split("::").pop().split(":")[0]),className:"h-5 lg:h-10 mr-1"}),(0,l.jsx)(r.BU,{lineID:t.split("::").pop().split(":")[0]})]}),Object.entries(i).sort((function(e,n){var t=(0,o.Z)(e,1)[0],i=(0,o.Z)(n,1)[0];return t.localeCompare(i)})).map((function(e){var n=(0,o.Z)(e,2),t=n[0],i=n[1];return(0,l.jsxs)("div",{className:"flex items-center bg-white border-gray-400 dark:text-white dark:bg-gray-700 min-h-[44px] max-h-[72px] p-1 lg:p-4",children:[(0,l.jsx)("div",{className:"ml-2 lg:ml-4 text-sm lg:text-base",children:(0,l.jsx)("p",{children:t})}),(0,l.jsx)("div",{className:"ml-auto",children:i.map((function(e,n){return(0,l.jsxs)("span",{className:"mr-2 text-sm lg:text-base bg-gray-800 text-yellow-500 rounded py-2 px-2",children:[e.minutesFromNow,"m"]},n)}))})]},t)}))]},t)}))})}},5166:function(e,n,t){t.r(n);var o=t(4165),i=t(5861),r=t(9439),l=t(9867),a=t(8100),u=t(5147),d=t(3397),c=t(470),s=t.n(c),v=(t(6948),t(2814)),f=t(342),m=t(3743),p=(t(1550),t(2834));n.default=function(){var e=(0,l.useState)(null),n=(0,r.Z)(e,2),t=n[0],c=n[1],h=(0,l.useState)(""),x=(0,r.Z)(h,2),g=x[0],y=x[1],j=(0,l.useRef)(),N=function(){var e=(0,l.useState)(null),n=(0,r.Z)(e,2),t=n[0],u=n[1];return(0,a.zV)({moveend:function(e){var n=e.target.getCenter();u(n)}}),(0,l.useEffect)((function(){if(t){var e=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var n,i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://prim.iledefrance-mobilites.fr/marketplace/navitia/coverage/fr-idf/coord/".concat(t.lng,";").concat(t.lat,"/stop_areas?distance=400"),{headers:{apikey:"l5iC8ZUjTN6WAevyFkU1tV8zkTbmNdjb"}});case 2:return n=e.sent,e.next=5,n.json();case 5:i=e.sent,console.log(i.stop_areas),y(i.stop_areas);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[t]),null},M=function(){return(0,p.jsx)("span",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-[1000] bg-violet-700 rounded-full p-2 border-4 border-white"})};(0,l.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){c([e.coords.latitude,e.coords.longitude])}),(function(e){console.error("Error occurred while getting geolocation: ",e),t||c([48.8598,2.347])}))}),[]);var b=function(){var e=(0,a.Sx)();return(0,l.useEffect)((function(){var n=new(s().Control)({position:"bottomright"});return n.onAdd=function(){var n=s().DomUtil.create("button","leaflet-bar leaflet-control leaflet-control-custom");return n.innerHTML='<svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 14 20"><path d="M7 0a7 7 0 0 0-1 13.92V19a1 1 0 1 0 2 0v-5.08A7 7 0 0 0 7 0Zm0 5.5A1.5 1.5 0 0 0 5.5 7a1 1 0 0 1-2 0A3.5 3.5 0 0 1 7 3.5a1 1 0 0 1 0 2Z"/></svg>',n.style.cssText="background-color: white; padding: 6px; cursor: pointer;",n.onclick=function(){return t&&e.flyTo(t,13)},n},n.addTo(e),function(){return n.remove()}}),[e]),null};return(0,p.jsxs)("div",{style:{height:"calc(100vh - 130px)"},children:[t&&(0,p.jsxs)(u.h,{className:"h-[40%]",whenCreated:function(e){j.current=e},center:t,zoom:13,attributionControl:!1,children:[(0,p.jsx)(d.I,{url:"https://{s}.tile.jawg.io/jawg-streets/{z}/{x}/{y}{r}.png?access-token=".concat("NLjqJ26jQLT3FtdLL3392vMpTDEAjiSi3aye5i0XblTjBD5Eo0N1Q5HjG5FReW7u")}),(0,p.jsx)(N,{}),(0,p.jsx)(b,{}),(0,p.jsx)(M,{}),f.map((function(e,n){return(0,p.jsx)(m.Q,{data:e.geo_shape.geometry,style:{color:"#"+e.colourweb_hexa}},n)}))]}),g&&(0,p.jsx)("div",{className:"h-[60%] overflow-y-scroll",children:g.map((function(e,n){return(0,p.jsx)(v.Z,{line:null,stationName:e.id.split(":").pop()})}))})]})}},3743:function(e,n,t){t.d(n,{Q:function(){return d}});var o=t(4925),i=t(5293),r=t(9457),l=t(5430),a=t(470),u=["data"],d=(0,i.Au)((function(e,n){var t=e.data,i=(0,o.Z)(e,u),d=new a.GeoJSON(t,i);return(0,r.O)(d,(0,l.sj)(n,{overlayContainer:d}))}),(function(e,n,t){n.style!==t.style&&(null==n.style?e.resetStyle():e.setStyle(n.style))}))},8100:function(e,n,t){t.d(n,{Sx:function(){return r},zV:function(){return l}});var o=t(5430),i=t(9867);function r(){return(0,o.mE)().map}function l(e){var n=r();return(0,i.useEffect)((function(){return n.on(e),function(){n.off(e)}}),[n,e]),n}}}]);
//# sourceMappingURL=344.322ad79a.chunk.js.map